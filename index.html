<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">

<!-- bootstrap -->

<p><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
<!-- bootstrap --></p>
<p></head>
<body>
<div class="container"></p>
<!--github-->

<p><a href="https://github.com/igrishaev/interview"><img style="position: absolute; top:
0; right: 0; border: 0;"
src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67"
alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
<!--github--></p>
<!--google-->

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-33533163-2', 'auto');
    ga('send', 'pageview');

</script>

<!--google-->

<h4><a href="http://grishaev.me/">&larr; Блог Ивана Гришаева</a></h4>

<h4><a href="http://grishaev.me/project-interview">&larr; Об этом документе</a></h4>

<h1>Собеседование. Вопросы для подготовки</h1>

<div class="toc">
<ul>
<li><a href="#_1">Питон</a><ul>
<li><a href="#_2">Строки</a><ul>
<li><a href="#_3">Какие виды строк бывают в питоне?</a></li>
<li><a href="#_4">Можно ли изменить отдельный символ внутри строки?</a></li>
<li><a href="#_5">Как соединить список строк в одну? Как разбить строку на список строк?</a></li>
<li><a href="#_6">Как кодировать и декодировать строки?</a></li>
<li><a href="#abc-uabc">Прокомментировать выражение 'ABC' == u'ABC'.</a></li>
</ul>
</li>
<li><a href="#_7">Списки, кортежи, словари, множества</a><ul>
<li><a href="#_8">Чем список отличается от кортежа?</a></li>
<li><a href="#_9">Как сделать список уникальным (без повторяющихся элементов)?</a></li>
<li><a href="#a-b-c">Есть кортеж из трех элементов. Назначить переменным a, b, c его значения.</a></li>
<li><a href="#_10">Как отсортировать список словарей по определенному полю?</a></li>
<li><a href="#_11">Что может являться ключом словаря? Что не может? Почему?</a></li>
<li><a href="#-">Есть два списка -- ключи и значения. Как составить из них словарь?</a></li>
<li><a href="#-_1">Где быстрее поиск элемента -— в списке или множестве?</a></li>
</ul>
</li>
<li><a href="#_12">Функции</a><ul>
<li><a href="#args-kwargs">Что такое *args, **kwargs, в каких случаях они требуются?</a></li>
<li><a href="#def-foobar">Почему def foo(bar=[]): плохо? Приведите пример плохого случая. Как исправить?</a></li>
<li><a href="#_13">Можно ли передавать функцию в качестве аргумента другой функции?</a></li>
<li><a href="#_14">Можно ли объявлять функцию внутри другой функции? Где она будет видна?</a></li>
<li><a href="#_15">Что такое лямбды? Каковы их особенности?</a></li>
<li><a href="#_16">Допустимы ли следующие выражения?</a></li>
</ul>
</li>
<li><a href="#_17">Декораторы</a><ul>
<li><a href="#_18">Что такое декораторы? Зачем нужны?</a></li>
<li><a href="#_19">Что может быть декоратором? К чему может быть применен декоратор?</a></li>
<li><a href="#_20">Что будет, если декоратор не возвращает ничего?</a></li>
<li><a href="#foobar-foobar">В чем отличие @foobar от @foobar()?</a></li>
<li><a href="#_21">Что такое фабрика декораторов?</a></li>
<li><a href="#wraps">Зачем нужен @wraps?</a></li>
</ul>
</li>
<li><a href="#_22">Итерация и генераторы</a><ul>
<li><a href="#x-for-x-in-y-x-for-x-in-y">В чем отличие [x for x in y] от (x for x in y)?</a></li>
<li><a href="#_23">Что особенного в генераторе?</a></li>
<li><a href="#_24">Как объявить генератор?</a></li>
<li><a href="#_25">Как получить из генератора список?</a></li>
<li><a href="#_26">Можно ли извлечь элемент генератора по индексу?</a></li>
<li><a href="#_27">Что возвращает итерация по словарю?</a></li>
<li><a href="#-_2">Как итерировать словарь по парам ключ-значение?</a></li>
</ul>
</li>
<li><a href="#_28">Классы, объекты</a><ul>
<li><a href="#_29">Как получить список атрибутов объекта?</a></li>
<li><a href="#_30">Что такое магические методы, для чего нужны?</a></li>
<li><a href="#_31">Как в классе сослаться на родительский класс?</a></li>
<li><a href="#mro">Возможно ли множественное наследование? Что такое MRO?</a></li>
<li><a href="#_32">Что такое миксины?</a></li>
<li><a href="#_33">Что такое контекстный менеджер? Как написать свой?</a></li>
<li><a href="#object-object">Прокомментировать выражение object() == object()</a></li>
<li><a href="#__slots__">Что такое __slots__? Плюсы, минусы.</a></li>
<li><a href="#_value-__value">В чем смысл параметров_value, __value</a></li>
</ul>
</li>
<li><a href="#_34">Многопоточность</a><ul>
<li><a href="#_35">Как в питоне реализуется многопоточность? Какие модули?</a></li>
<li><a href="#gil">Что такое GIL? Как работает? Какие проблемы?</a></li>
<li><a href="#_36">В чем отличие тредов от мультипроцессинга?</a></li>
<li><a href="#_37">Какие задачи хорошо параллелятся, какие плохо?</a></li>
<li><a href="#100">Нужно посчитать 100 уравнений. Делать это в тредах или нет?</a></li>
<li><a href="#_38">Треды в Питоне — это нативные треды или нет?</a></li>
<li><a href="#_39">Что такое гринлеты? Общее понятие. Примеры реализаций.</a></li>
</ul>
</li>
<li><a href="#_40">Джанго</a><ul>
<li><a href="#middleware">Что такое Middleware, для чего, как реализуется?</a></li>
<li><a href="#_41">Назовите основные мидлвари? Зачем они нужны?</a></li>
<li><a href="#csrf-middleware">Опишите алгоритм работы CSRF middleware</a></li>
<li><a href="#_42">Что такое сигналы? Зачем нужны? Назовите основные?</a></li>
<li><a href="#m2m">Как реализуется связь m2m на уровне базы данных?</a></li>
<li><a href="#get-post">Чем лучше отправлять форму — GET или POST?</a></li>
<li><a href="#rest">Что такое REST?</a></li>
<li><a href="#xss">Что такое XSS? Примеры? Как защитить приложение?</a></li>
</ul>
</li>
<li><a href="#_43">Тесты</a></li>
</ul>
</li>
<li><a href="#-_3">Веб-разработка</a><ul>
<li><a href="#cgi">Что такое CGI? Плюсы, минусы?</a></li>
<li><a href="#csrf">Что такое CSRF?</a></li>
<li><a href="#_44">Как защитить куки от воровства и от подделки?</a></li>
</ul>
</li>
<li><a href="#http">HTTP</a><ul>
<li><a href="#http_1">Как устроен протокол HTTP?</a></li>
<li><a href="#raw">Написать raw запрос главной Яндекса</a></li>
<li><a href="#_45">Как клиенту понять, удался запрос или нет?</a></li>
<li><a href="#_46">Что нужно отправить браузеру, чтобы перенаправить на другую страницу?</a></li>
<li><a href="#http_2">Как управлять кешированием в HTTP?</a></li>
<li><a href="#_47">Как кэшируются файлы на уровне протокола?</a></li>
</ul>
</li>
<li><a href="#_48">СУБД</a></li>
<li><a href="#_49">Джаваскрипт</a></li>
<li><a href="#_50">Деплой</a></li>
<li><a href="#_51">Алгоритмы, структуры</a><ul>
<li><a href="#_52">Что такое рекурсия? Какие минусы, плюсы?</a></li>
<li><a href="#_53">Что такое хвостовая рекурсия?</a></li>
<li><a href="#_54">Опишите быструю сортировку. Какова ее сложность?</a></li>
<li><a href="#-_4">Что такое О-нотация?</a></li>
<li><a href="#_55">Задачи на алгоритмы</a></li>
</ul>
</li>
<li><a href="#_56">Практика</a></li>
<li><a href="#orm">Задача на ORM</a></li>
<li><a href="#_57">Проектирование</a></li>
</ul>
</div>
<h2 id="_1">Питон</h2>
<h3 id="_2">Строки</h3>
<h4 id="_3">Какие виды строк бывают в питоне?</h4>
<p>Зависит от версии Питона. Во второй ветке два типа: однобайтные строки
и Юникод представлены классами <code>str</code> и <code>unicode</code> соответственно. В
третьем Питоне есть один вид строк <code>str</code>, который представляет собой
Юникод. Однобайтных строк нет, вместо них есть тип <code>bytes</code>, то есть
цепочка байт.</p>
<h4 id="_4">Можно ли изменить отдельный символ внутри строки?</h4>
<p>Нет, строки неизменяемы. Операции замены, форматирования и
конкатенации возвращают новую строку.</p>
<h4 id="_5">Как соединить список строк в одну? Как разбить строку на список строк?</h4>
<p>Чтобы соединить, нужен метод строки <code>.join()</code>. Чтобы разбить, метод
<code>.split()</code>.</p>
<h4 id="_6">Как кодировать и декодировать строки?</h4>
<p>Кодировать -- перевести Юникод в байтовую строку. Вызвать метод
<code>.encode()</code> у объекта <code>unicode</code>.</p>
<p>Декодировать -- восстановить Юникод из цепочки байт. Вызвать метод
<code>.decode()</code> у объекта <code>str</code> или <code>bytes</code> (версии Питона 2 и 3
соответственно).</p>
<p>В обоих случаях явно передавать кодировку, иначе будет использована та,
что определена в системе по умолчанию. Быть готовым поймать исключения
<code>UnicodeEncodeError</code>, <code>UnicodeDecodeError</code>.</p>
<h4 id="abc-uabc">Прокомментировать выражение <code>'ABC' == u'ABC'</code>.</h4>
<p>Строки сравниваются по кодам символов. Если обе строки набраны
латиницей, их коды попарно равны, и строки в результате тоже равны.</p>
<p>Если хотя бы одна буква набрана русским символом, то строки равны не
будут. Например, русская буква <code>А</code> имеет код, отличный от латинской
буквы <code>A</code>.</p>
<p>Помните, что символы из нижней части таблицы ASCII имеют одни и те же
коды в любой кодировке.</p>
<h3 id="_7">Списки, кортежи, словари, множества</h3>
<h4 id="_8">Чем список отличается от кортежа?</h4>
<p>На уровне языка отличаются тем, что в кортеж нельзя добавить или
убрать элемент. На уровне интерпретатора различий нет. Обе коллекции
представлены массивом указателей на структуру <code>PyObject</code>.</p>
<p>Для списка определены функции, которые добавляют в такой массив новый
элемент, удаляют имеющийся, соединяют два массива в один. Они
вызываются методами списка <code>.append()</code>, <code>.pop()</code>, <code>.sort()</code> и т.д.</p>
<h4 id="_9">Как сделать список уникальным (без повторяющихся элементов)?</h4>
<ul>
<li>Вариант со множеством. Не гарантирует порядок элементов. Порядок
  сохраняется только для маленьких списков.</li>
</ul>
<div class="codehilite"><pre><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>


<ul>
<li>Вариант с циклом. Медленно, но гарантирует порядок. Подходит, если
  элементы словаря нельзя помещать внутрь множества (например,
  словари).</li>
</ul>
<div class="codehilite"><pre><span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>


<h4 id="a-b-c">Есть кортеж из трех элементов. Назначить переменным <code>a, b, c</code> его значения.</h4>
<div class="codehilite"><pre><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>


<h4 id="_10">Как отсортировать список словарей по определенному полю?</h4>
<p>Метод списка <code>.sort()</code> и встроенная функция <code>sorted()</code> принимают
параметр <code>key</code>. Им должен быть вызываемый объект, который принимает
очередной элемент (в нашем случае словарь) и возвращает
значение-критерий сортировки.</p>
<p>Код ниже показывает, как отсортировать список людей по возрасту:</p>
<div class="codehilite"><pre><span class="n">users</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}]</span>
<span class="n">users</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">user</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}]</span>
</pre></div>


<h4 id="_11">Что может являться ключом словаря? Что не может? Почему?</h4>
<p>Ключом словаря может быть любой неизменяемый объект: число, строка,
<code>datetime</code>, функция и даже модуль. Такие объекты имеют метод
<code>__hash__()</code>, который однозначно сопоставляет объект с некоторым
числом. По этому числу словарь ищет значение для ключа.</p>
<p>Списки, словари и множества изменяемы и не имеют метода хеширования.
При подстановке их в словарь возникнет ошибка.</p>
<p>Хеш кортежа вычисляется рекурсивно по всем элементам. Так, кортеж</p>
<div class="codehilite"><pre><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="p">))))</span>
</pre></div>


<p>состоит только из неизменяемых элементов, поэтому может быть
ключом. Однако, такой кортеж</p>
<div class="codehilite"><pre><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="p">({</span><span class="s1">&#39;hello&#39;</span><span class="p">:</span> <span class="s1">&#39;world&#39;</span><span class="p">},</span> <span class="p">))))</span>
</pre></div>


<p>содержит глубоко внутри словарь, поэтому хеш не может быть рассчитан.</p>
<h4 id="-">Есть два списка -- ключи и значения. Как составить из них словарь?</h4>
<div class="codehilite"><pre><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">]</span>
<span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">vals</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">{</span><span class="s1">&#39;baz&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>


<p>Функция <code>zip</code> отдает список пар N-ых элементов. Конструктор <code>dict</code>
принимает список пар. Каждую пару он рассматривает как ключ и значение
соответственно.</p>
<h4 id="-_1">Где быстрее поиск элемента -— в списке или множестве?</h4>
<p>Во множестве, потому что множество работает как словарь. Значение
ищется по хешу ключа. Вычисление хеша и сопоставление адреса --
операции постоянной сложности, поэтому принято говорить, что поиск в
словаре равен <code>O(1)</code>.</p>
<p>Исключение работает только для очень маленьких списков длиной до 5
элементов. В этом случае интерпретатору будет быстрей пробежаться по
списку, чем считать хеш.</p>
<h3 id="_12">Функции</h3>
<h4 id="args-kwargs">Что такое <code>*args</code>, <code>**kwargs</code>, в каких случаях они требуются?</h4>
<p>Выражения <code>*args</code> и <code>**kwargs</code> объявляют в сигнатуре функции. Они
означают, что внутри функции будут доступны переменные с именами
<code>args</code> и <code>kwargs</code> (без звездочек). Можно использовать другие имена, но
это считается дурным тоном.</p>
<p><code>args</code> -- это кортеж, который накапливает позиционные
аргументы. <code>kwargs</code> -- словарь позиционных аргументов, где ключ -- имя
параметра, значение -- значение параметра.</p>
<p><strong>Важно:</strong> если в функцию не передано никаких параметров, переменные
будут соответственно равны пустому кортежу и пустому словарю, а не
<code>None</code>.</p>
<p>Пожалуйста, не путайте кортеж со списком. Следующий вопрос объясняет,
почему.</p>
<h4 id="def-foobar">Почему <code>def foo(bar=[]):</code> плохо? Приведите пример плохого случая. Как исправить?</h4>
<p>Функция создается однажды при загрузке модуля. Именованные параметры и
их дефолтные значения тоже создаются один раз и хранятся в одном из
полей объекта-функции.</p>
<p>В нашем примере <code>bar</code> равен пустому списку. Список -- изменяемая
коллекция, поэтому значение <code>bar</code> может изменяться от вызова
к вызову. Пример:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">bar</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">bar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bar</span>
<span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">foo</span><span class="p">()</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>


<p>Хорошим тоном считается указывать параметру пустое неизменяемое
значение, например <code>0</code>, <code>None</code>, <code>''</code>, <code>False</code>. В теле функции
проверять на заполненность и создавать новую коллекцию:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">bar</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bar</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bar</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bar</span>
<span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<p>Сказанное выше актуально в т.ч. для множеств и словарей.</p>
<h4 id="_13">Можно ли передавать функцию в качестве аргумента другой функции?</h4>
<p>Можно, функция в Питоне объект первого порядка: допускает
присваивание, передачу в функцию, удаление.</p>
<h4 id="_14">Можно ли объявлять функцию внутри другой функции? Где она будет видна?</h4>
<p>Можно. Такая функция будет видна только внутри первой функции.</p>
<h4 id="_15">Что такое лямбды? Каковы их особенности?</h4>
<p>Это анонимные функции. Они не резервируют имени в пространстве
имен. Лямбды часто передают в функции <code>map</code>, <code>reduce</code>, <code>filter</code>.</p>
<p>Лямбды в Питоне могут состоять только из одного выражения. Используя
синтаксис скобок, можно оформить тело лямбды в несколько строк.</p>
<p>Использовать точку с запятой для разделения операторов нельзя.</p>
<h4 id="_16">Допустимы ли следующие выражения?</h4>
<ul>
<li><code>nope = lambda: pass</code></li>
<li><code>riser = lambda x: raise Exception(x)</code></li>
</ul>
<p>Нет, при загрузке модуля выскочит исключение <code>SyntaxError</code>. В теле
лямбды может быть только выражение. <code>pass</code> и <code>raise</code> являются
операторами.</p>
<h3 id="_17">Декораторы</h3>
<h4 id="_18">Что такое декораторы? Зачем нужны?</h4>
<p>Декоратор в широком смысле -- паттерн проектирования, когда один
объект изменяет поведение другого. В Питоне декоратор, как правило,
это функция A, которая принимает функцию B и возвращает функцию C. При
этом функция C задействует в себе функцию B.</p>
<p>Задекорировать функцию значит заменить ее на результат работы
декоратора.</p>
<h4 id="_19">Что может быть декоратором? К чему может быть применен декоратор?</h4>
<p>Декоратором может быть любой вызываемый объект: функция, лямбда,
класс, экземпляр класса. В последнем случае определите метод
<code>__call__</code>.</p>
<p>Применять декоратор можно к любому объекту. Чаще всего к функциям,
методам и классам. Декорирование встречается настолько часто, что под
него выделен особый оператор <code>@</code>.</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">auth_only</span><span class="p">(</span><span class="n">view</span><span class="p">):</span>
    <span class="o">...</span>

<span class="nd">@auth_only</span>
<span class="k">def</span> <span class="nf">dashboard</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>


<p>Если бы оператора декорирования не существовало, мы бы записали код
выше так:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">auth_only</span><span class="p">(</span><span class="n">view</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">dashboard</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>

<span class="n">dashboard</span> <span class="o">=</span> <span class="n">auth_only</span><span class="p">(</span><span class="n">dashboard</span><span class="p">)</span>
</pre></div>


<h4 id="_20">Что будет, если декоратор не возвращает ничего?</h4>
<p>Если в теле функции нет оператора <code>return</code>, вызов вернет
<code>None</code>. Помним, результат декоратора замещает декорируемый объект. В
нашем случае декоратор вернет <code>None</code> и функция, которую мы декорируем,
тоже станет <code>None</code>. При попытке вызвать ее после декорирования получим
ошибку <code>NoneType is not callable</code>.</p>
<h4 id="foobar-foobar">В чем отличие <code>@foobar</code> от <code>@foobar()</code>?</h4>
<p>Первое -- обычное декорирование функцией <code>foobar</code>.</p>
<p>Второй случай -- декорирование функцией, которую вернет вызов
<code>foobar</code>. По-другому это называется параметрический декоратор или
фабрика декораторов. См. следующий вопрос.</p>
<h4 id="_21">Что такое фабрика декораторов?</h4>
<p>Это функция, которая возвращает декоратор. Такой декоратор редко
помещают в отдельную переменную. Вместо этого декорируют результатом
вызова фабрики декораторов.</p>
<p>Например, вам нужен декоратор для проверки прав. Логика проверки
одинакова, но прав может быть много. Чтобы не плодить копипасту,
напишем фабрику декораторов.</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">has_perm</span><span class="p">(</span><span class="n">perm</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">view</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">view</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">HTTPRedirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>
    <span class="k">return</span> <span class="n">decorator</span>

<span class="nd">@has_perm</span><span class="p">(</span><span class="s1">&#39;view_user&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">users</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>


<h4 id="wraps">Зачем нужен <code>@wraps</code>?</h4>
<p><code>wraps</code> -- декоратор из стандартной поставки Питона, модуль
<code>functools</code>. Он назначает функции-врапперу те же поля <code>__name__</code>,
<code>__module__</code>, <code>__doc__</code>, что и у исходной функции, которую вы
декорируете. Это нужно для того, чтобы после декорирования
функция-враппер не выглядела в стектрейсах как исходная функция.</p>
<h3 id="_22">Итерация и генераторы</h3>
<h4 id="x-for-x-in-y-x-for-x-in-y">В чем отличие <code>[x for x in y]</code> от <code>(x for x in y)</code>?</h4>
<p>Первое выражение возвращает список, второе -- генератор.</p>
<h4 id="_23">Что особенного в генераторе?</h4>
<p>Генератор хранит в памяти не все элементы, а только внутреннее
состояние для вычисления очередного элемента. На каждом шаге можно
вычислить только следующий элемент, но не предыдущий. Пройти генератор
в цикле можно только один раз.</p>
<h4 id="_24">Как объявить генератор?</h4>
<ul>
<li>использовать синтаксис <code>(x for x in seq)</code></li>
<li>оператор <code>yield</code> в теле функции вместо <code>return</code></li>
<li>встроенная функция <code>iter</code>, которая вызывает у объекта метод
  <code>__iter__()</code>. Этот метод должен возвращать генератор.</li>
</ul>
<h4 id="_25">Как получить из генератора список?</h4>
<p>Передать его в конструктор списка: <code>list(x for x in some_seq)</code>. Важно,
что после этого по генератору уже нельзя будет итерироваться.</p>
<h4 id="_26">Можно ли извлечь элемент генератора по индексу?</h4>
<p>Нет, будет ошибка. Генератор не поддерживает метод <code>__getitem__</code>.</p>
<h4 id="_27">Что возвращает итерация по словарю?</h4>
<p>Ключ. Порядок следования ключей не гарантируется. Для маленьких
словарей порядок будет тот же, что и в объявлении. Для больших порядок
зависит от расположения элементов в памяти. Особый класс <code>OrderedDict</code>
учитывает порядок добавления ключей.</p>
<div class="codehilite"><pre><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}:</span>
    <span class="n">process_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>


<h4 id="-_2">Как итерировать словарь по парам ключ-значение?</h4>
<p>Метод словаря <code>.iteritems()</code> возвращает генератор кортежей <code>(key,
value)</code>.</p>
<h3 id="_28">Классы, объекты</h3>
<h4 id="_29">Как получить список атрибутов объекта?</h4>
<p>Функция <code>dir</code> возвращает список строк -- полей объекта. Поле
<code>__dict__</code> содержит словарь вида <code>{поле -&gt; значение}</code>.</p>
<h4 id="_30">Что такое магические методы, для чего нужны?</h4>
<p>Магическими метода называют методы, имена которых начинаются и
заканчиваются двойным подчеркиванием. Магические они потому, что почти
никогда не вызываются явно. Их вызывают встроенные функции или
синтаксические конструкции. Например, функция <code>len()</code> вызывает метод
<code>__len__()</code> переданного объекта. Метод <code>__add__(self, other)</code>
вызывается автоматически при сложении оператором <code>+</code>.</p>
<p>Перечислим некоторые магические методы:</p>
<ul>
<li><code>__init__</code>: конструктор класса</li>
<li><code>__add__</code>: сложение с другим объектом</li>
<li><code>__eq__</code>: проверка на равенство с другим объектом</li>
<li><code>__cmp__</code>: сравнение (больше, меньше, равно)</li>
<li><code>__iter__</code>: при подстановке объекта в цикл</li>
</ul>
<h4 id="_31">Как в классе сослаться на родительский класс?</h4>
<p>Функция <code>super</code> принимает класс и экземпляр:</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">NextClass</span><span class="p">(</span><span class="n">FirstClass</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NextClass</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</pre></div>


<h4 id="mro">Возможно ли множественное наследование? Что такое MRO?</h4>
<p>Да, можно указать более одного родителя в классе потомка.</p>
<p><code>MRO</code> -- method resolution order, порядок разрешения
методов. Алгоритм, по которому следует искать метод в случае, если у
класса два и более родителей. Алгоритм линеизирует граф
наследования. Коротко можно описать так: ищи слева направо. Поэтому
чем правее стоит класс, тем меньше у него приоритет при поиске метода.</p>
<h4 id="_32">Что такое миксины?</h4>
<p>Миксин (mix-in, анг. "примесь"), паттерн проектирования в ООП, когда в
цепочку наследования добавляется небольшой класс-помощник. Например,
есть класс</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">NowMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">now</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
</pre></div>


<p>Тогда любой класс, наследованный с этим миксином, будет иметь метод
<code>now()</code>.</p>
<h4 id="_33">Что такое контекстный менеджер? Как написать свой?</h4>
<p>В питоне есть оператор <code>with</code>. Размещенный внутри код выполняется с
особенностью: до и после гарантированно срабатывают события входа в
блок <code>with</code>и выхода из него. Объект, который определяет логику
событий, называется контекстным менеджером.</p>
<p>На уровне класса события определены методами <code>__enter__</code> и
<code>__exit__</code>. Первый срабатывает в тот момент, когда ход исполнения
программы переходит внутрь <code>with</code>. Метод может вернуть значение. Оно
будет доступно низлежащему внутри блока <code>with</code> коду.</p>
<p><code>__exit__</code> срабатывает в момент выхода блока, в т.ч. и по причине
исключения. В этом случае в метод будет передана тройка значений
<code>(exc_class, exc_instance, traceback)</code>.</p>
<p>Самый распространённый контекстный менеджер -- класс, порожденный
функцией <code>open</code>. Он гарантирует, что файл будет закрыт даже в том
случае, если внутри блока возникнет ошибка.</p>
<p>Старайтесь выходить из контекстного менеджера как можно быстрее, чтобы
освобождать контекст и ресурсы.</p>
<div class="codehilite"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">process_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>


<p>В примере выше мы вышли из блока <code>with</code> сразу же после прочтения
файла. Обработка данных происходит в основном блоке программы.</p>
<p>Контекстные менеджеры можно использовать для временной замены
параметров, переменных окружения, транзакций БД.</p>
<h4 id="object-object">Прокомментировать выражение <code>object() == object()</code></h4>
<p>Всегда ложь, поскольку по умолчанию объекты сравниваются по полю id
(адрес в памяти), если только не переопределен метод <code>__eq__</code>.</p>
<ul>
<li>Как удаляется объект?</li>
</ul>
<h4 id="__slots__">Что такое <code>__slots__</code>? Плюсы, минусы.</h4>
<p>Классы хранят поля и их значения в секретном словаре
<strong>dict</strong>. Поскольку словарь -- изменяемая структура, вы можете на лету
добавлять и удалять из класса поля. Параметр <strong>slots</strong> в классе жестко
фиксирует набор полей класса. Слоты используются когда у класса может
быть очень много полей, например, в некоторых <code>ORM</code>, либо когда
критична производительность, потому что доступ к слоту срабатывает
быстрее, чем поиск в словаре.</p>
<p>Слоты активно используются в библиотеках <code>requests</code> и <code>falcon</code>.</p>
<p>Недостатки: нельзя присвоить классу поле, которого нет в слотах. Не
работают методы <code>__getattr__</code> и <code>__setattr__</code>.</p>
<h4 id="_value-__value">В чем смысл параметров<code>_value, __value</code></h4>
<p>Поле класса с одним лидирующим подчеркиванием говорит о том, что
параметр используется только внутри класса. При этом он доступен для
обращения извне.</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bar</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">Foo</span><span class="p">()</span><span class="o">.</span><span class="n">_bar</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">42</span>
</pre></div>


<p>Современные ИДЕ вроде <code>PyCharm</code> подсвечивают обращение к полю с
подчеркиванием, но ошибки в процессе исполнения не будет.</p>
<p>Поля с двойным подчеркиванием доступны внутри класса, но недоступны
извне. Это достигается хитрым приемом: интерпретатор назначает таким
полям имена вида <code>_&lt;ClassName&gt;__&lt;fieldName&gt;</code>. Зная это правило, можно
получить значение скрытого поля вне класса, но это смотрится очень
уродливо.</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__bar</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">Foo</span><span class="p">()</span><span class="o">.</span><span class="n">__bar</span>
<span class="o">&gt;&gt;&gt;</span> <span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;Foo&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;__bar&#39;</span>
<span class="n">Foo</span><span class="p">()</span><span class="o">.</span><span class="n">_Foo__bar</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">42</span>
</pre></div>


<h3 id="_34">Многопоточность</h3>
<h4 id="_35">Как в питоне реализуется многопоточность? Какие модули?</h4>
<p>Многопоточность достигается модулем Threading. Это нативные
Posix-треды. Такие треды исполняются операционной системой, а не
виртуальной машиной.</p>
<h4 id="gil">Что такое GIL? Как работает? Какие проблемы?</h4>
<p>Global Interpreter Lock. Особенность интерпретатора, когда
одновременно может исполняться только один тред. Все это время
остальные треды простаивают. GIL есть не только в Питоне, но и в
других скриптовых языках, например, Руби.</p>
<p>Причина существования GIL в том, что для этих интерпретаторов еще не
найден безопасный способ согласовывать изменения данных. Например,
если один тред удалит все элемены из списка, а второй начнет итерацию
по нему, гарантированно произойдет ошибка.</p>
<p>GIL работает так: на каждый тред выделяется некоторый квант
времени. Он измеряется в машинных единицах "тиках" и по умолчанию
равен 100. Как только на тред было потрачено 100 тиков, интерпретатор
бросает этот тред и переключается на второй, тратит 100 тактов на
него, затем третий, и так по кругу. Этот алгоритм гарантирует, что всем
тредам будет выделено ресурсов поровну.</p>
<p>Проблема в том, что из-за GIL далеко не все задачи могут быть решены в
тредах. Напротив, их использование чаще всего снижает быстродействие
программы. С использованием тредов требуется следить за доступом к
общим ресурсам: словарям, файлам, соединением к БД.</p>
<h4 id="_36">В чем отличие тредов от мультипроцессинга?</h4>
<p>Главное отличие в разделении памяти. Процессы независимы друг от
друга, имеют раздельные адресные пространства, идентификаторы,
ресурсы. Треды исполняются в совместном адресном порстранстве, имеют
общий доступ к памяти, переменным, загруженным модулям.</p>
<h4 id="_37">Какие задачи хорошо параллелятся, какие плохо?</h4>
<p>Те задачи, которые порождают долгий IO. Когда тред упирается в
ожидание сокета или диска, интерпретатор бросает этот тред и стартует
следующий. Это значит, не будет простоя из-за ожидания. Наоборот, если
ходить в сеть в одном треде (в цикле), то каждый раз придется ждать
ответа.</p>
<p>Однако, если затем в треде обрабатывает полученные данные,
то выполнятся будет только он один. Это не только не даст прироста в
скорости, но и замедлит программу из-за переключения на другие треды.</p>
<p>Короткий ответ: хорошо ложатся на треды задачи по работе с
сетью. Например, выкачать сто урлов. Полученные данные обрабатывайте
вне тредов.</p>
<h4 id="100">Нужно посчитать 100 уравнений. Делать это в тредах или нет?</h4>
<p>Нет, потому что в этой задаче нет ввода-вывода. Интерпретатор только
будет тратить лишнее время на переключение тредов. Сложные
математические задачи лучше выносить в отдельные процессы, либо
использовать фреймворк для распределенных задач Celery, либо
подключать как C-библиотеки.</p>
<h4 id="_38">Треды в Питоне — это нативные треды или нет?</h4>
<p>Да, это нативные Posix-совместимые треды, которые исполняются на
уровне операционной системы.</p>
<h4 id="_39">Что такое гринлеты? Общее понятие. Примеры реализаций.</h4>
<p>Greenlet == Green thread == Зеленые треды == легковесные треды внутри
виртуальной машины. Могут называться корутинами, сопроцессами,
акторами и т.д. в зависимости от платформы. Операционная система не
видит их. С точки зрения ОС запущен один процесс виртуальной машины, а
что внутри нее -- неизвестно. Такими тредами управляет сама вируальная
машина: порождает, исполняет, согласует доступ к ресурсам.</p>
<p>Примеры: корутины в языках Go и Lua, легковесные процессы в Erlang,
модуль greenlet для Python.</p>
<h3 id="_40">Джанго</h3>
<h4 id="middleware">Что такое Middleware, для чего, как реализуется?</h4>
<p>Middleware -- особый объект, который изменяет входящий запрос или
исходящий ответ. Например, добавляет заголовки, делает предварительные
проверки. Middleware нужен, когда требуется подвергнуть обработке все
запросы приложения.</p>
<p>На уровне языка это объект с методами <code>process_request</code> и
<code>process_response</code>. Методы должны вернуть принятый объект (запрос или
ответ) для дальнейшей обработки или выкинуть исключение, если что-то
не в порядке. В этом случает дальнейшая обработка прекращается.</p>
<p>Чтобы включить Middleware, достаточно добавить путь к нему в кортеж
<code>MIDDLEWARE_CLASSES</code>.</p>
<h4 id="_41">Назовите основные мидлвари? Зачем они нужны?</h4>
<ul>
<li><code>SessionMiddleware</code> -- поддержка сессий. Добавляет в запрос объект
  <code>session</code></li>
<li><code>CsrfViewMiddleware</code> -- проверяет, что POST-запросы отправлены с
  текущего домена</li>
<li><code>AuthenticationMiddleware</code> -- авторизует пользователя. Добавляет в
  запрос поле <code>user</code></li>
<li>
<p><code>MessageMiddleware</code> -- передает пользователю короткие сообщения</p>
</li>
<li>
<p>Опишите алгоритм работы auth middleware, распознавание юзера</p>
</li>
</ul>
<h4 id="csrf-middleware">Опишите алгоритм работы CSRF middleware</h4>
<p>На каждый запрос система генерирует уникальный токен и выставляет его
в куках. В каждой форме размещается скрытое поле <code>csrf-token</code> с этим
же токеном. При отправке формы методом <code>POST</code> Джанго проверяет, что
поле формы и значение в куках совпадают. Если нет, это значит, что
запрос подделан или отправлен с другого домена.</p>
<p>Чтобы освободить какую-то вьюху от проверки (если это API, например),
достаточно обернуть ее декоратором <code>csrf_except</code>.</p>
<h4 id="_42">Что такое сигналы? Зачем нужны? Назовите основные?</h4>
<p>Сигналы -- это события в экосистеме Джанго. С помощью сигналов
подсистемы оповещают приложение о том, что случилось. Чтобы читать
сигналы, программист регистрирет обработчики сигналов. Сигналы
распространяются синхронно. Это значит, подписав на один сигнал сотню
обработчиков, мы увеличим время, необходимое на отдачу ответа.</p>
<p>Основные сигналы это начало запроса и его окончание, перед сохранением
модели и после, обращение к базе данных.</p>
<p><strong>Важно:</strong> сигналы моделей работают поштучно, то есть для одной
модели. При пакетной обработке, например, <code>queryset.all().delete()</code>
или <code>queryset.all().update({'foo'=42})</code>, события об удалении или
изменения не будут вызваны.</p>
<ul>
<li>Как определить свои фильтры для шаблонной системы?</li>
<li>Что такое ORM? Как в Джанго организовать связь между моделями?</li>
</ul>
<h4 id="m2m">Как реализуется связь m2m на уровне базы данных?</h4>
<p>Если есть модели A и B со связью многие ко многим, то создается
таблица-мост с именем <code>a_to_b</code>, которая хранит ключ на A, ключ на B и
дополнительные сведения, например, время, когда была создана
связь. Эта таблица сцепляется с A и B оператором <code>JOIN</code>.</p>
<ul>
<li>Как разворачивали веб-приложения в продакшене?</li>
</ul>
<h4 id="get-post">Чем лучше отправлять форму — GET или POST?</h4>
<p>Форму можно отправлять обоими способами. В первом случае переменные
прикрепляются к строке запроса после вопросительного знака. Во втором
-- передаются в теле запроса.</p>
<p>Техническое ограничение метода GET в том, что им нельзя передать файл,
в отличие от POST.</p>
<p>Форму желательно передавать методом POST по следующим причинам:</p>
<ul>
<li>GET-запросы могут быть кешированы, особенно в браузерах семейства IE</li>
<li>GET-запросы оседают в логах провайдера, сервера, истории
  браузера. Пароль и логин засветиться во многих местах</li>
<li>некоторые вирусы отслеживают содержимое адресной строки и пересылают
  третьим лицам.</li>
</ul>
<h4 id="rest">Что такое REST?</h4>
<p><code>REST (Representational state transfer)</code> -- соглашение о том, как
выстраивать сервисы. Под REST часто имеют в виду т.н <code>HTTP REST
API</code>. Как правило, это веб-приложение с набором урлов -- конечных
точек. Урлы принимают и возвращают данные в формате <code>JSON</code>. Тип
операции задают методом HTTP-запроса, например:</p>
<ul>
<li><code>GET</code> -- получить объект или список объект</li>
<li><code>POST</code> -- создать объект</li>
<li><code>PUT</code> -- обновить существующий объект</li>
<li><code>DELETE</code> -- удалить объект</li>
<li><code>HEAD</code> -- получить метаданные объекта</li>
</ul>
<p>REST-архитектура актвивно использует возможности протокола HTTP, чтобы
избежать т.н. "велосипедов" -- собственных решений. Например,
параметры кеширования передаются стандартными заголовками <code>Cache</code>,
<code>If-Modified-Since</code>, <code>ETag</code>. Авторизациция -- заголовком
<code>Authentication</code>.</p>
<h4 id="xss">Что такое XSS? Примеры? Как защитить приложение?</h4>
<p>XSS -- межсайтовые запросы. Страница, подверженная уязвимости,
вынуждает пользователя выполнить запрос к другой странице, либо
запустить нежелательный js-код.</p>
<p>Например, пользователь отправил комментарий, в котором был код:</p>
<div class="codehilite"><pre><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>


<p>Движок сайта не фильтрует текст комментария, поэтому тег <code>&lt;script&gt;</code>
становится частью страницы и исполняется браузером. Каждый, кто зайдет
на страницу с опасным комментарием, увидет всплаывющее окно с тестом
<code>foo</code>.</p>
<p>Другой пример. Страница поиска принимает поисковой терм <code>q</code>. В
заголовке фраза "Результат поиска по запросу" + текст параметра. Если
не экранировать параметр, то запрос
<code>/search?q=&lt;script&gt;alert('foo');&lt;/script&gt;</code> приведет к аналогичному
результату.</p>
<p>Зная, что страница выполняет js-код, хакер может подгрузить на
страницу контекстную рекламу, баннеры, заставить браузей перейти на
любую страницу, похитить куки.</p>
<p>Уязвимость устраняется экранированием небезопасных символов, чисткой
(санацией) HTML-тегов.</p>
<h3 id="_43">Тесты</h3>
<ul>
<li>Какие тулзы для тестов?</li>
<li>Как тестировать запросы в сеть, базу?</li>
</ul>
<h2 id="-_3">Веб-разработка</h2>
<h4 id="cgi">Что такое CGI? Плюсы, минусы?</h4>
<p>Common Gateway Interface. Соглашение о том, как веб-сервер
взаимодействует с программой, написанной на каком-то языке. Веб-сервер
запускает программу как исполняемый файл. Параметры запроса, например,
метод, путь, заголовки и т.д. передаются через переменные окружения.</p>
<p>Программа должна прочитать эти переменные и записать в стандартный
поток вывода HTTP-ответ.</p>
<p>Плюсы:</p>
<ul>
<li>Протокол не накладывает условия на язык, на котором написана
программа. Это может быть и скрипт, и бинарный файл.</li>
<li>Протокол экстремально прост.</li>
<li>Программа не хранит состояние, что удобно для отладки.</li>
</ul>
<p>Минусы:</p>
<ul>
<li>Запуск процесса ОС на каждый запрос отрабатывает очень медленно.</li>
<li>Передача данных через <code>stdout</code> медленней юникс-сокетов.</li>
</ul>
<h4 id="csrf">Что такое CSRF?</h4>
<p><code>Сross Site Request Forgery</code> (межсайтовая подделка запроса). Вид
уязвимости, когда сайт А вынуждает пользователя выполнить запрос на
сайт Б. Это может быть тег img или script для GET-запроса, или форма
со специальным атрибутом target.</p>
<p>Чтобы предотвратить уязвимость, сайт Б должен убедиться, что запрос
пришел именно с его страницы.</p>
<p>Например, пользователь должен заполнить форму. В нее помещают скрытое
поле token -- одноразовую последовательность символов. Этот же токен
сохраняют в куки пользователя. При отправке формы поле и куки должны
совпасть. Способ не является надежным и обходится скриптом.</p>
<h4 id="_44">Как защитить куки от воровства и от подделки?</h4>
<p>Зависит от того, насколько строгие критерии безопасности на
сайте. Если в куках хранятся вспомогательные данные, например, индекс
последнего выбранного в дропдауне элемента, правилами ниже можно
пренебречь.</p>
<p>Для платежных систем, сайтов с приватными данными приведенные правила
обязательны.</p>
<ul>
<li>Выставлять кукам флаг <code>httponly</code>. Браузер не даст прочесть и
  изменить такие куки на клиенте Джаваскриптом.</li>
<li>Использовать флаг <code>secure</code>. Куки будут переданы только по
  безопасному соединению.</li>
<li>Устанавливать короткий срок жизни куки.</li>
<li>Устанавливать короткий срок сессии на сервере.</li>
<li>Добавлять в ключ сессии заголовок <code>User-Agent</code>. Тогда если украсть
  куки и установить на другой машине, ключ сессии будет другим.</li>
<li>Аналогично пункту выше, но добавлять <code>IP</code> пользователя.</li>
<li>Подписывать куки секретным ключом. Добавлять поле <code>sig</code>, которое
  равно <code>HMAC-SHA1(cookie-body, secret_key)</code>. На сервере проверять,
  что подпись совпадает.</li>
</ul>
<h2 id="http">HTTP</h2>
<h4 id="http_1">Как устроен протокол HTTP?</h4>
<p>HTTP -- текстовый протокол, работающий поверх TCP/IP. HTTP состоит из
запроса и ответа. Их структуры похожи: стартовая строка, заголовки,
тело ответа.</p>
<p>Стартовая строка запроса состоит из метода, пути и версии протокола:</p>
<div class="codehilite"><pre><span class="nf">GET</span> <span class="nn">/index.html</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>


<p>Стартовая строка ответа состоит из версии протокола, кода ответа и
текстовой расшифровке ответа.</p>
<div class="codehilite"><pre>HTTP/1.1 200 OK
</pre></div>


<p>Заголовки -- это набор пар ключ-значение, например, <code>User-Agent</code>,
<code>Content-Type</code>. В заголовках передают метаданные запроса: язык
пользователя, авторизацию, перенаправление. Заголовок <code>Host</code> должен
быть в запросе всегда.</p>
<p>Тело ответа может быть пустым, либо может передавать пары переменных,
файлы, бинарные данные. Тело отделяется от заголовков пустой строкой.</p>
<h4 id="raw">Написать raw запрос главной Яндекса</h4>
<div class="codehilite"><pre><span class="nf">GET</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">ya.ru</span>
</pre></div>


<h4 id="_45">Как клиенту понять, удался запрос или нет?</h4>
<p>Проверить статус ответа. Ответы разделены старшему разряду. Имеем пять
групп со следующей семантикой:</p>
<ul>
<li><code>1xx</code>: используется крайне редко. В этой группе только один статус
  <code>100 Continue</code>.</li>
<li><code>2xx</code>: запрос прошел успешно (данные получены или созданы)</li>
<li><code>3xx</code>: перенаправление на другой ресурс</li>
<li><code>4xx</code>: ошибка по вине пользователя (нет такой страницы, нет прав на
  доступ)</li>
<li><code>5xx</code>: ошибка по вине сервера (ошибка в коде, сети, конфигурации)</li>
</ul>
<h4 id="_46">Что нужно отправить браузеру, чтобы перенаправить на другую страницу?</h4>
<p>Минимальный ответ должен иметь статус <code>301</code> или <code>302</code>. Заголовок
<code>Location</code> указывает адрес ресурса, на который следует перейти.</p>
<p>В теле ответа можно разместить <code>HTML</code> со ссылкой на новый
ресурс. Тогда пользователи старых браузеров смогут перейти вручную.</p>
<h4 id="http_2">Как управлять кешированием в HTTP?</h4>
<p>Существуют несколько способов кешировать данные на уровне протокола.</p>
<ul>
<li>Заголовки <code>Cache</code> и <code>Cache-Control</code> регулируют сразу несколько
  критериев кеша: время жизни, политику обновления, поведение
  прокси-сервера, тип данных (публичные, приватные).</li>
<li>Заголовки <code>Last-Modified</code> и <code>If-Modified-Since</code> задают кеширование в
  зависимости от даты обновления документа.</li>
<li>Заголовок <code>Etag</code> кеширует документ по его уникальному хешу.</li>
</ul>
<h4 id="_47">Как кэшируются файлы на уровне протокола?</h4>
<p>Когда <code>Nginx</code> отдает статичный файл, он добавляет заголовок <code>Etag</code> --
<code>MD5</code>-хеш файла. Клиент запоминает этот хеш. В следующий раз при
запросе файла клиент посылает хеш. Сервер проверяет хеш клиента для
этого файла. Если хеш не совпадает (файл обновили), сервер отвечает с
кодом <code>200</code> и выгружает актуальный файл с новым хешем. Если хеши
равны, сервер отвечает с кодом <code>304 Not Modified</code> с пустым телом. В
этом случае браузер подставляет локальную копию файла.</p>
<h2 id="_48">СУБД</h2>
<ul>
<li>Что делает оператор JOIN, какие виды бывают?</li>
<li>Что делает оператор HAVING, примеры?</li>
<li>В каких случаях вы бы предпочли нереляционную БД?</li>
<li>Что такое SQL-инъекции, какие меры против?</li>
<li>Что такое функциональный индекс?</li>
<li>Что такое транзакиця, ее свойства?</li>
<li>Что такое область видимости транзакции?</li>
</ul>
<h2 id="_49">Джаваскрипт</h2>
<ul>
<li>Отличие == от ===?</li>
<li>Что такое замыкания, примеры?</li>
<li>Как реализовано ООП, особенности?</li>
<li>JSONP - в чем идея, как реализуется</li>
<li>На клиенте случилась ошибка, как известить сервер?</li>
<li>В чем разница <code>function foo() {...}</code> и <code>var foo = function() {...}</code></li>
<li>Прокомментировать выражение:</li>
</ul>
<div class="codehilite"><pre>(function($) {
    $(function() {
        alert(123);
    });
})(jQuery);
</pre></div>


<ul>
<li>Написать простой класс-вектор (x, y) с одним методом.</li>
</ul>
<h2 id="_50">Деплой</h2>
<ul>
<li>Описать схему деплоя типичного приложения. Основные компоненты.</li>
</ul>
<h2 id="_51">Алгоритмы, структуры</h2>
<h4 id="_52">Что такое рекурсия? Какие минусы, плюсы?</h4>
<p>Рекурсия -- определение функции через саму себя. Логика рекурсивной
функции как правило состоит из двух ветвей. Длинная ветвь вызывает эту
же функцию с другими параметрами, чтобы накопить результат. Короткая
ветвь определяет критерий выхода из рекурсии.</p>
<p>Рекурсия упрощает код и делает его декларативным. Рекурсия поощряет
мыслить функционально и избегать побочных эффектов.</p>
<p>Неоптимизированная рекурсия приводит к накладным расходам
ресурсов. При большом количестве итераций можно превысить лимит на
число рекурсивных вызовов (recursion depth limit reached).</p>
<h4 id="_53">Что такое хвостовая рекурсия?</h4>
<p>Это особый вид рекурсии, когда функция заканчивается вызовом самой
себя без дополнительных операторов. Когда это условие выполняется,
компилятор разворачивает рекурсию в цикл с одним стек-фреймом, просто
меняя локальные переменные от итерации к итерации.</p>
<p>Так, классическое определение рекурсивного факториала <code>return N *
fact(N - 1)</code> не поддерживает хвостовую рекурсию, потому что для
каждого стек-фрейма придется хранить текущее значение <code>N</code>.</p>
<p>Чтобы сделать рекурсии хвостовой, добавляют
параметры-аккумуляторы. Благодаря им функция знает о своем текущем
состоянии. Пусть параметр <code>acc</code> по умолчанию равен 1. Тогда запись с
хвостовой рекурсией будет выглядеть так:</p>
<div class="codehilite"><pre><span class="k">def</span> <span class="nf">fact</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">acc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fact</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">acc</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
</pre></div>


<h4 id="_54">Опишите быструю сортировку. Какова ее сложность?</h4>
<p>На первом этапе выбирают опорный элемент. Чаще всего его берут из
середины массива. Затем последовательно сравнивают первый элемент
массива с последним, второй с предпоследним и т.д. Если элемент слева
от опорного элемента больше правого, они меняются местами. Когда
доходят до опорного элемента, итерация считается законченной.</p>
<p>Далее описанный выше алгоритм применяют для двух подмассивов. Первый
-- от первого элемента до опорного элемента (не включительно), второй
-- от опорного до последнего.</p>
<p>Рекурсивный спуск продолжается, пока длины подмассивов не станут равны
единице.</p>
<p>Сложность быстрой сортировки в среднем случае равна <code>log(N)</code>.</p>
<h4 id="-_4">Что такое О-нотация?</h4>
<p>todo</p>
<h3 id="_55">Задачи на алгоритмы</h3>
<ul>
<li>Как извлечь элементы массива в случайном порядке без повторений?</li>
</ul>
<h2 id="_56">Практика</h2>
<ul>
<li>Написать декоратор, который выводит на экран время работы произвольной функции.</li>
<li>Написать декоратор, который возвращает либо результат, либо экземпляр исключения.</li>
<li>Написать генератор Фибоначчи от a и b.</li>
<li>Получить из файла текст в юникоде.</li>
<li>Написать генератор чисел Фибоначчи вида <code>def fib(a=1, b=2):</code></li>
</ul>
<h2 id="orm">Задача на ORM</h2>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">City</span>(<span class="n">models</span>.<span class="n">Model</span>):
    <span class="nb">name</span> = <span class="n">models</span>.<span class="n">CharField</span>()


<span class="k">class</span> <span class="n">Person</span>(<span class="n">models</span>.<span class="n">Model</span>):
    <span class="nb">name</span> = <span class="n">models</span>.<span class="n">CharField</span>()
    <span class="n">city</span> = <span class="n">models</span>.<span class="n">ForeignKey</span>(<span class="n">City</span>)
</pre></div>


<ul>
<li>Вывести список людей и городов где они живут?</li>
<li>Вывести всех людей, живущих в городе N</li>
<li>Вывести 5 городов с наибольшим населением, упорядочив по убыванию.</li>
</ul>
<h2 id="_57">Проектирование</h2>
<ul>
<li>Сервис сокращалки урлов</li>
</ul>
<!--disqus-->

<div id="disqus_thread"></div>

<script>
    /**
    * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');

    s.src = '//igrishaev.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

<!--disqus-->

<p></div>
</body>
</html></p>